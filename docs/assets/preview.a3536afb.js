import{a as R,S as v,i as A,D as O,u as h,U as _}from"./iframe.bfa73eee.js";const p={hover:"hover",active:"active",focusVisible:"focus-visible",focusWithin:"focus-within",focus:"focus",visited:"visited",link:"link",target:"target"},b=e=>e.indexOf("@")===0,x=e=>{if(b(e))return[e];let n=[],s=0,t=0,a="";for(let c=0,o=e.length;c<o;c++){const r=e[c];if(r==="(")s+=1;else if(r===")")s-=1;else if(r==="[")t+=1;else if(r==="]")t-=1;else if(r===","&&!s&&!t){n.push(a.trim()),a="";continue}a+=r}return n.push(a.trim()),n},E=Object.values(p),y=new RegExp(":(".concat(E.join("|"),")")),D=new RegExp(":(".concat(E.join("|"),")"),"g"),S=new Set,m=e=>{S.has(e)||(console.warn(e),S.add(e))},j=(e,n,s)=>e.replace(n,x(n).flatMap(t=>{if(t.includes(".pseudo-"))return[];if(!y.test(t))return[t];const a=[],c=t.replace(D,(i,l)=>(a.push(l),"")),o=a.reduce((i,l)=>i.replace(new RegExp(":".concat(l),"g"),".pseudo-".concat(l)),t);if(t.startsWith(":host(")||t.startsWith("::slotted("))return[t,o];const r=s?":host(".concat(a.map(i=>".pseudo-".concat(i)).join(""),") ").concat(c):"".concat(a.map(i=>".pseudo-".concat(i)).join("")," ").concat(c);return[t,o,r].filter(i=>!i.includes(":not()"))}).join(", ")),T=(e,n,s)=>{if(!e.__pseudoStatesRewritten){e.__pseudoStatesRewritten=!0;try{let t=0;for(const{cssText:a,selectorText:c}of e.cssRules){if(y.test(c)){const o=j(a,c,n);e.deleteRule(t),e.insertRule(o,t),n&&s.add(n.host)}if(t++,t>1e3){m("Reached maximum of 1000 pseudo selectors per sheet, skipping the rest.");break}}}catch(t){t.toString().includes("cssRules")?m("Can't access cssRules, likely due to CORS restrictions: ".concat(e.href)):console.error(t,e.href)}}},u=R.getChannel(),f=new Set,w=(e,n)=>{e.className=e.className.split(" ").filter(s=>s&&s.indexOf("pseudo-")!==0).concat(...n).join(" ")},N=(e,n)=>{const s=new Map([[e,new Set]]),t=(a,c)=>s.set(a,new Set([...s.get(a)||[],c]));Object.entries(n||{}).forEach(a=>{let[c,o]=a;typeof o=="boolean"?t(e,o&&c):typeof o=="string"?e.querySelectorAll(o).forEach(r=>t(r,c)):Array.isArray(o)&&o.forEach(r=>e.querySelectorAll(r).forEach(i=>t(i,c)))}),s.forEach((a,c)=>{const o=[];a.forEach(r=>p[r]&&o.push("pseudo-".concat(p[r]))),w(c,o)})},g=e=>{const n=new Set;for(let s=e.parentElement;s;s=s.parentElement)!s.className||s.className.split(" ").filter(t=>t.indexOf("pseudo-")===0).forEach(t=>n.add(t));w(e,n)},C=(e,n)=>{let{viewMode:s,parameters:t,id:a,globals:c}=n;const{pseudo:o}=t,{pseudo:r}=c;return h(()=>{o!==r&&s==="story"&&u.emit(_,{globals:{pseudo:o}})},[o,s]),h(()=>{const i=setTimeout(()=>{const l=document.getElementById(s==="docs"?"story--".concat(a):"root");N(l,r||o),f.forEach(g)},0);return()=>clearTimeout(i)},[r,o,s]),e()},d=e=>{var n;let s=e?e.styleSheets:document.styleSheets;e!=null&&(n=e.adoptedStyleSheets)!==null&&n!==void 0&&n.length&&(s=e.adoptedStyleSheets),Array.from(s).forEach(t=>T(t,e,f))};u.on(v,()=>f.clear());u.on(A,()=>d());u.on(O,()=>d());Element.prototype.attachShadow&&(Element.prototype._attachShadow=Element.prototype.attachShadow,Element.prototype.attachShadow=function(n){const s=this._attachShadow({...n,mode:"open"});return requestAnimationFrame(()=>{d(s),g(s.host)}),s});const P=[C];export{P as decorators};
//# sourceMappingURL=preview.a3536afb.js.map
